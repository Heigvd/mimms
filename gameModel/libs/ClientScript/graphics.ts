import { getAfflictedBlocks } from "./currentPatientZoom";
import { add, interpolate, normalize, Point } from "./helper";
import {  BlockName, BodyPosition, extBlocks, Glasgow, HumanBody } from "./HUMAn";
import { Categorization, getCurrentPatientBody, getHuman, getHumans, lineOfSightRadius, Located } from "./the_world";
import { Category, getCategory } from "./triage";

export interface HumanOverview {
	height_cm: number;
	gcs: Glasgow,
	position: BodyPosition;
	colorful: number;
	cyanosis: boolean;
	looksDead: boolean;
	totalExternalBloodLosses_ml: number;
	category: Category<string> | undefined;
	rr: number;
	tidalVolume_L: number;
}


function getCategoryCardSvgRect(id: string, x : number=0, y: number = 0, size: number=4): string {
	const human = getHuman(id);
	if (human != null) {
		const overview = getOverview(human);
		if (overview?.category) {
			return `<rect fill="${overview.category.bgColor}" stroke="grey" stroke-width="0.2" x="${x}" y="${y}" width="${size}" height="${size}" >
			<title>${overview.category.name}</title>
			</rect>`;
		}
	}
	return '';
}


interface PictoConfig {
	className: string;
	bloodRatio: number
};

function getPicoClassNames(overview: HumanOverview): PictoConfig {
	const classes: string[] = ["mouth_neutral"];
	// Eyes
	if (overview.looksDead) {
		classes.push("eyes_dead")
	} else if (overview.gcs.eye > 3) {
		if (true) {
			classes.push("eyes_AlertMinus");
		} else {
			classes.push("eyes_AlertPlus");
		}
	} else {
		classes.push("eyes_N-A");
	}

	let bloodRatio = normalize(overview.totalExternalBloodLosses_ml / 500, { max: 1 });
	if (overview.totalExternalBloodLosses_ml > 0) {
		classes.push("blood");
	}

	return {
		className: classes.join(" "),
		bloodRatio: bloodRatio,
	};
}

function getStanding(height_px: number, classes: string, bloodStyle: string) {
	return `<svg class="body_picto ${classes}" height="${height_px}" viewBox="0 0 176 496" fill="none" xmlns="http://www.w3.org/2000/svg">
    <g class="standing_position">
	    <path style="${bloodStyle} transform-origin:50% 95%;" class="blood"
       d="m 30.922255,441.74969 c 16.264053,-0.6557 32.429901,-3.36763 48.292074,-6.95282 0.524257,-1.38996 0.453248,-3.40692 0.74937,-4.85278 0.901964,-4.38593 5.109617,-3.27849 9.126906,-3.31173 4.62313,-0.0393 8.981865,0.55447 13.561185,0.93369 10.07419,0.83549 20.18918,0.6844 30.27697,1.40205 8.91388,0.63303 20.25566,0.78411 27.71914,6.58116 7.50579,5.82877 10.69364,13.24089 9.97902,22.7183 -0.87477,11.62128 -14.34531,17.11012 -23.79553,21.6985 -8.75071,4.24845 -17.44703,8.82323 -26.6102,12.14403 -4.23333,1.53349 -11.37803,4.71076 -16.20513,3.73627 -6.705045,-1.35219 -12.443166,-6.45123 -18.933679,-8.57696 -6.890882,-2.25567 -14.221415,-4.21672 -21.494536,-4.58536 -7.037432,-0.35807 -12.822388,2.22847 -19.359737,4.24542 -9.729725,3.00202 -21.943251,0.16921 -31.088287,-3.69397 -15.8349772,-6.68843 -17.7718574,-30.45978 -3.539867,-39.82993 6.333387,-4.1714 14.330194,-1.37485 21.322301,-1.65587 z"
       fill="#c40000"
       style="stroke-width:1.51083" />
        <g class="standing_body">
            <path d="M71.3465 69.4553C91.6137 69.1704 100.093 53.0507 99.8155 33.3169C99.5381 13.5832 88.7116 0.149543 68.4445 0.434438C48.1774 0.719334 37.3586 22.1844 37.636 41.9182C37.7921 53.0238 51.0794 69.7402 71.3465 69.4553Z" fill="black"/>
            <path fill-rule="evenodd" clip-rule="evenodd" d="M86.3711 75.8102C82.0574 74.6945 76.9957 74.0638 71.0593 74.0638C50.5335 74.0638 37.2021 77.9119 28.7852 84.9433C18.8432 91.1677 13.5243 109.197 11.0306 120.88C8.17542 134.257 4.92996 151.878 4.92996 176.197L4.92995 225.34L6.85547 269.507C4.64144 272.427 1.51204 280.181 0.931641 284C0.35124 287.819 4.00038 310.558 10.9316 312.5C13.2245 313.143 14.7664 313.141 15.8394 312.779C14.9308 326.57 14.3245 341.232 14.3627 351.5C14.4316 370 29.4316 443 29.4316 443C25.5435 443.969 22.1709 444.474 19.2825 444.907C13.9665 445.703 10.29 446.254 8.05586 449C4.6078 453.238 5.80743 464.508 9.93165 467.254C13.0721 469.345 32.9915 468.252 44.6619 467.611L44.666 467.611C48.3199 467.41 51.1646 467.254 52.4316 467.254C57.7454 467.254 52.4316 441.5 52.4316 441.5C52.4316 441.5 46.4316 372 46.4316 357C46.4316 345.399 57.5466 301.378 64.6613 274.264C66.4191 280.662 68.5229 287.973 70.7215 295.613L70.7217 295.614C77.5407 319.311 85.2725 346.179 86.4316 358.832C88.4316 380.663 92.4316 447 92.4316 447L92.2322 467.726H139.432C141.941 463.65 137.939 451.266 131.086 448.5C130.17 448.13 129.334 447.78 128.557 447.453C125.037 445.976 122.708 444.999 119.432 444.992C119.432 444.992 122.076 377.169 121.932 356C121.829 340.945 118.375 319.604 115.639 302.693C114.527 295.826 113.534 289.689 112.932 285C109.682 259.713 106.354 245.285 101.974 237.082C104.834 235.763 107.423 233.607 109.44 230.077C111.162 227.062 111.102 224.609 111.057 222.802C111.016 221.117 110.988 219.994 112.432 219.5C130.72 213.245 175.274 180.5 175.274 176.137C175.274 165.298 127.66 109.702 116.485 96.6548C115.663 95.6944 115.038 94.9646 114.644 94.5001C109.56 88.5089 97.7637 78.0587 86.3711 75.8102ZM109.717 135.786C108.549 148.639 106.138 159.477 103.913 169.473C102.104 177.604 100.418 185.178 99.6266 192.827C99.1562 197.372 98.3798 203.871 97.4778 211.137C98.504 210.954 99.6552 210.918 100.997 211.097C107.907 212.014 116.974 202.936 126.134 193.766C134.121 185.77 142.177 177.704 148.932 176.137L109.717 135.786ZM28.7888 234.376C24.3272 243.235 21.646 259.981 19.3978 276.678C18.4149 274.361 17.0275 272.682 16.1244 271.589C15.8771 271.29 15.666 271.034 15.5096 270.822C18.2337 257.965 18.8998 243.927 19.5617 229.979C20.3533 213.297 21.1387 196.745 25.4316 182.5L25.9962 178.704C29.754 200.4 32.3351 221.991 28.7888 234.376Z" fill="black"/>
        </g>
        <g class="eyes_N-A">
            <path class="eye_left" d="M94.6749 42.5507C92.8233 42.6991 91.4685 42.3023 89.8643 41.52" stroke="white" stroke-width="3" stroke-linecap="round"/>
            <path class="eye_right" d="M67.1501 37.5925C70.5148 42.0164 78.1681 42.452 81.8053 40.0194" stroke="white" stroke-width="3" stroke-linecap="round"/>
        </g>
        <g class="eyes_AlertMinus">
            <path class="eye_left_2" d="M88.1661 34.0531C89.6141 34.2381 91.8771 35.4484 92.3447 37.1251C92.6224 38.121 91.354 39.8298 90.8298 40.5511C90.0012 41.6913 88.6465 42.1674 87.4332 41.3464C84.1589 39.131 84.8382 33.3398 89.2468 33.7828" stroke="white" stroke-width="5" stroke-linecap="round"/>
            <path class="eye_right_2" d="M69.0007 34.2146C71.7506 32.5755 75.5727 32.6446 77.0209 35.801C78.0985 38.1499 76.064 41.1448 74.0798 41.9446C69.5127 43.7853 65.2035 34.061 71.5726 33.595" stroke="white" stroke-width="5" stroke-linecap="round"/>
        </g>
        <g class="eyes_AlertPlus">
            <path class="eye_left_3" d="M85.2848 30.6231C87.7731 30.8881 91.6995 32.7992 92.5689 35.513C93.0853 37.125 90.9819 39.9337 90.1133 41.1192C88.7402 42.9929 86.4387 43.8002 84.3265 42.4959C78.6265 38.9759 79.5541 29.5459 87.1253 30.157" stroke="white" stroke-width="7" stroke-linecap="round"/>
            <path class="eye_right_3" d="M59.6191 30.044C63.5441 27.599 69.0658 27.5903 71.2466 32.1078C72.8694 35.4694 70.0161 39.8522 67.1732 41.0634C60.6298 43.8512 54.131 29.9297 63.3159 29.0763" stroke="white" stroke-width="7" stroke-linecap="round"/>
        </g>
        <g class="eyes_dead">
            <g class="Group 3">
                <path class="Vector 25" d="M75.414 31.2358C73.2924 33.4231 72.1372 36.5591 70.7007 39.2615C69.3542 41.7944 68.3241 44.4987 66.9977 47.0407" stroke="white" stroke-width="3" stroke-linecap="round"/>
                <path class="Vector 26" d="M64.9878 33.5598C67.8236 35.1256 70.204 37.2609 72.7236 39.3859C73.7804 40.2772 74.8891 41.0812 75.8422 42.0846" stroke="white" stroke-width="3" stroke-linecap="round"/>
            </g>
            <g class="Group 4">
                <path class="Vector 25_2" d="M92.967 32.4264C90.9276 33.9088 89.5416 36.3014 87.9877 38.3006C86.5313 40.1745 85.3084 42.233 83.867 44.1172" stroke="white" stroke-width="3" stroke-linecap="round"/>
                <path class="Vector 26_2" d="M83.1389 34.3369C85.7947 35.5028 88.1551 37.247 90.632 38.9673C91.6709 39.6888 92.7399 40.3235 93.7088 41.1603" stroke="white" stroke-width="3" stroke-linecap="round"/>
            </g>
        </g>
        <path class="mouth_happy" d="M82.6887 54.8816C80.5699 56.9469 78.6111 58.2873 75.6984 58.3636C74.0178 58.4075 72.2741 58.1352 70.6778 57.5431C69.4304 57.0804 68.4223 55.9875 67.4361 55.0775" stroke="white" stroke-width="3" stroke-linecap="round"/>
        <path class="mouth_neutral" d="M74.3293 53.8318C77.9775 54.4233 82.3577 54.0927 85.6048 55.5243" stroke="white" stroke-width="3" stroke-linecap="round"/>
    </g>
</svg>`;
}


function getSitting(height_px: number, classes: string, bloodStyle: string) {
	return `<svg class="body_picto ${classes}" height="${height_px / 2}" viewBox="0 0 291 301" fill="none" xmlns="http://www.w3.org/2000/svg">
    <g class="sitting_position">
        <path style="${bloodStyle} transform-origin:32% 88%;" class="blood" d="M166.466 265.073C177.231 264.639 187.931 262.844 198.43 260.471C198.777 259.551 198.73 258.216 198.926 257.259C199.523 254.356 202.308 255.089 204.967 255.067C208.027 255.041 210.912 255.434 213.943 255.685C220.611 256.238 227.306 256.138 233.983 256.613C239.883 257.032 247.39 257.132 252.33 260.969C257.298 264.827 259.408 269.733 258.935 276.006C258.356 283.698 249.44 287.331 243.185 290.368C237.393 293.18 231.637 296.208 225.572 298.406C222.77 299.421 218.041 301.524 214.846 300.879C210.408 299.984 206.61 296.609 202.314 295.202C197.753 293.709 192.901 292.411 188.087 292.167C183.429 291.93 179.6 293.642 175.273 294.977C168.833 296.964 160.749 295.089 154.696 292.532C144.215 288.105 142.933 272.371 152.353 266.169C156.545 263.408 161.838 265.259 166.466 265.073Z" fill="#C40000"/>
        <g class="body">
            <path d="M108.845 45.8995C102.945 66.2019 89.2075 80.0579 68.3564 73.9985C47.5054 67.9391 39.1323 46.6507 42.4526 35.2251C48.3525 14.9227 66.162 -3.67588 87.0131 2.38351C107.864 8.44289 114.745 25.5971 108.845 45.8995Z" fill="black"/>
            <path d="M30.0474 86.9381C23.4832 95.1831 18.4884 104.866 17 108.5C4.75034 138.412 2.80027 166.8 2.01008 189.043C1.67312 198.528 1.67024 206.507 1.66751 214.046C1.6653 220.167 1.6632 225.999 1.48253 232.113C1.26191 239.579 1.81554 245.139 2.99257 249.157C2.98705 252.413 3.89926 255.558 6.00001 258.5C21.0514 279.575 53.5324 265.289 67.2125 252.029C68.3304 251.359 69.3816 250.687 70.3546 250.022C79.2462 243.948 106.126 224.393 128.189 208.248L158.853 253.811L156.624 273.164H219.219C219.219 272.259 219.236 271.353 219.253 270.452C219.383 263.361 219.507 256.6 211.46 253.811C202.389 250.668 192.42 247.297 184.169 247.949C184.169 247.949 174.744 227.225 162.935 204.105L238.082 265.555L235.666 282.085L290.092 278.076C290.852 268.102 289.338 265.005 279.746 261.522C275.239 259.886 271.108 259.895 266.798 259.905C262.147 259.915 257.286 259.926 251.519 257.871C251.519 257.871 209.52 205.935 179.462 174.372C175.158 180.735 169.003 188.712 157.049 187.953C154.88 187.816 153.268 187.326 151.995 186.707C151.375 186.405 150.877 186.093 150.491 185.837L150.442 185.804C150.185 186.049 149.826 186.416 149.341 186.959C145.748 190.977 140.145 194.444 133.757 197.439C127.311 200.461 119.796 203.125 112.135 205.428C96.8098 210.035 80.6405 213.27 70.7102 215.025L69.2021 215.292L68.1017 214.227C57.7219 204.18 49.4233 185.8 43.2588 169.392C40.1447 161.103 37.5186 153.153 35.4171 146.786C33.2644 140.263 31.7574 135.718 30.8181 133.844C29.2767 130.77 28.0058 125.958 27.1999 120.622C26.3842 115.222 26.0055 109.019 26.3861 103.043C26.751 97.3117 27.827 91.5772 30.0474 86.9381Z" fill="black"/>
            <path d="M38.9031 77.9425C39.9596 77.5166 41.0973 77.2059 42.3206 77.0294C49.0371 76.0604 54.3307 77.4003 58.3985 80.616C62.3545 83.7433 64.7845 88.3612 66.4562 93.2389C68.1325 98.1298 69.1606 103.638 70.0778 108.825C70.1605 109.293 70.2423 109.758 70.3235 110.22C71.1608 114.98 71.9373 119.393 73.0614 123.137L73.0842 123.213L87.175 181.101C92.2256 179.567 99.3692 177.824 106.821 176.006C110.67 175.067 114.601 174.108 118.369 173.148C124.852 171.495 130.903 169.828 135.492 168.212C137.794 167.402 139.631 166.638 140.937 165.938C141.59 165.588 142.042 165.29 142.331 165.055C142.471 164.941 142.543 164.867 142.573 164.834C144.397 161.108 146.843 159.271 149.349 158.003C150.123 157.611 150.989 157.235 151.758 156.901L151.762 156.899C152.099 156.753 152.417 156.615 152.7 156.487C153.726 156.024 154.638 155.559 155.503 154.945L156.283 154.392H157.239C157.648 154.392 158.051 154.402 158.448 154.423C155.441 152.121 153.08 150.792 151.568 150.705C148.694 150.542 142.761 152.436 135.154 155.546C129.658 147.687 124.844 142.486 121.5 142C117.611 141.434 110.448 145.017 101.897 150.704L81.3603 155.43C83.5644 142.992 85.1753 132.118 85.8113 124.398C88.1111 96.4814 84.7767 85.0823 53.2203 74.2187C48.459 72.5796 43.5364 74.4012 38.9031 77.9425Z" fill="black"/>
            <path d="M163.072 158.263C161.299 157.711 159.357 157.392 157.239 157.392C155.781 158.426 154.29 159.073 152.84 159.702C149.939 160.961 147.204 162.147 145.234 166.222C143.313 170.194 124.185 174.86 107.305 178.978C99.827 180.802 92.7901 182.518 87.8854 184.019C86.8276 184.343 85.8691 184.657 85.0266 184.959L70.1881 124C69.01 120.076 68.2027 115.483 67.374 110.769C64.5554 94.7348 61.4898 77.2949 42.749 79.9987C24.7627 82.5935 28.1676 121.863 33.5 132.5C34.5583 134.611 36.139 139.401 38.2181 145.701C44.519 164.793 55.3976 197.756 70.1881 212.071C89.944 208.579 134.349 199.224 147.105 184.959C149.916 181.816 150.455 182.184 151.839 183.127C152.829 183.801 154.249 184.769 157.239 184.959C167.573 185.615 172.866 178.799 177.178 172.394C177.107 172.186 177.028 171.968 176.94 171.743C171.809 166.435 167.09 161.813 163.072 158.263Z" fill="black"/>
            <path d="M108.845 45.8995C102.945 66.2019 89.2075 80.0579 68.3564 73.9985C47.5054 67.9391 39.1323 46.6507 42.4526 35.2251C48.3525 14.9227 66.162 -3.67588 87.0131 2.38351C107.864 8.44289 114.745 25.5971 108.845 45.8995Z" stroke="black"/>
            <path d="M30.0474 86.9381C23.4832 95.1831 18.4884 104.866 17 108.5C4.75034 138.412 2.80027 166.8 2.01008 189.043C1.67312 198.528 1.67024 206.507 1.66751 214.046C1.6653 220.167 1.6632 225.999 1.48253 232.113C1.26191 239.579 1.81554 245.139 2.99257 249.157C2.98705 252.413 3.89926 255.558 6.00001 258.5C21.0514 279.575 53.5324 265.289 67.2125 252.029C68.3304 251.359 69.3816 250.687 70.3546 250.022C79.2462 243.948 106.126 224.393 128.189 208.248L158.853 253.811L156.624 273.164H219.219C219.219 272.259 219.236 271.353 219.253 270.452C219.383 263.361 219.507 256.6 211.46 253.811C202.389 250.668 192.42 247.297 184.169 247.949C184.169 247.949 174.744 227.225 162.935 204.105L238.082 265.555L235.666 282.085L290.092 278.076C290.852 268.102 289.338 265.005 279.746 261.522C275.239 259.886 271.108 259.895 266.798 259.905C262.147 259.915 257.286 259.926 251.519 257.871C251.519 257.871 209.52 205.935 179.462 174.372C175.158 180.735 169.003 188.712 157.049 187.953C154.88 187.816 153.268 187.326 151.995 186.707C151.375 186.405 150.877 186.093 150.491 185.837L150.442 185.804C150.185 186.049 149.826 186.416 149.341 186.959C145.748 190.977 140.145 194.444 133.757 197.439C127.311 200.461 119.796 203.125 112.135 205.428C96.8098 210.035 80.6405 213.27 70.7102 215.025L69.2021 215.292L68.1017 214.227C57.7219 204.18 49.4233 185.8 43.2588 169.392C40.1447 161.103 37.5186 153.153 35.4171 146.786C33.2644 140.263 31.7574 135.718 30.8181 133.844C29.2767 130.77 28.0058 125.958 27.1999 120.622C26.3842 115.222 26.0055 109.019 26.3861 103.043C26.751 97.3117 27.827 91.5772 30.0474 86.9381Z" stroke="black"/>
            <path d="M38.9031 77.9425C39.9596 77.5166 41.0973 77.2059 42.3206 77.0294C49.0371 76.0604 54.3307 77.4003 58.3985 80.616C62.3545 83.7433 64.7845 88.3612 66.4562 93.2389C68.1325 98.1298 69.1606 103.638 70.0778 108.825C70.1605 109.293 70.2423 109.758 70.3235 110.22C71.1608 114.98 71.9373 119.393 73.0614 123.137L73.0842 123.213L87.175 181.101C92.2256 179.567 99.3692 177.824 106.821 176.006C110.67 175.067 114.601 174.108 118.369 173.148C124.852 171.495 130.903 169.828 135.492 168.212C137.794 167.402 139.631 166.638 140.937 165.938C141.59 165.588 142.042 165.29 142.331 165.055C142.471 164.941 142.543 164.867 142.573 164.834C144.397 161.108 146.843 159.271 149.349 158.003C150.123 157.611 150.989 157.235 151.758 156.901L151.762 156.899C152.099 156.753 152.417 156.615 152.7 156.487C153.726 156.024 154.638 155.559 155.503 154.945L156.283 154.392H157.239C157.648 154.392 158.051 154.402 158.448 154.423C155.441 152.121 153.08 150.792 151.568 150.705C148.694 150.542 142.761 152.436 135.154 155.546C129.658 147.687 124.844 142.486 121.5 142C117.611 141.434 110.448 145.017 101.897 150.704L81.3603 155.43C83.5644 142.992 85.1753 132.118 85.8113 124.398C88.1111 96.4814 84.7767 85.0823 53.2203 74.2187C48.459 72.5796 43.5364 74.4012 38.9031 77.9425Z" stroke="black"/>
            <path d="M163.072 158.263C161.299 157.711 159.357 157.392 157.239 157.392C155.781 158.426 154.29 159.073 152.84 159.702C149.939 160.961 147.204 162.147 145.234 166.222C143.313 170.194 124.185 174.86 107.305 178.978C99.827 180.802 92.7901 182.518 87.8854 184.019C86.8276 184.343 85.8691 184.657 85.0266 184.959L70.1881 124C69.01 120.076 68.2027 115.483 67.374 110.769C64.5554 94.7348 61.4898 77.2949 42.749 79.9987C24.7627 82.5935 28.1676 121.863 33.5 132.5C34.5583 134.611 36.139 139.401 38.2181 145.701C44.519 164.793 55.3976 197.756 70.1881 212.071C89.944 208.579 134.349 199.224 147.105 184.959C149.916 181.816 150.455 182.184 151.839 183.127C152.829 183.801 154.249 184.769 157.239 184.959C167.573 185.615 172.866 178.799 177.178 172.394C177.107 172.186 177.028 171.968 176.94 171.743C171.809 166.435 167.09 161.813 163.072 158.263Z" stroke="black"/>
        </g>
        <g class="eyes_N-A">
            <path class="eye_left" d="M103.545 53.9695C101.721 53.6149 100.523 52.8685 99.188 51.6839" stroke="white" stroke-width="3" stroke-linecap="round"/>
            <path class="eye_right" d="M78.3651 41.7962C80.4171 46.9616 87.6716 49.438 91.8289 48.0726" stroke="white" stroke-width="3" stroke-linecap="round"/>
        </g>
        <g class="eyes_AlertMinus">
            <path class="eye_left_2" d="M101.938 46.226C103.184 46.9862 104.756 49.015 104.498 50.7365C104.345 51.759 102.489 52.8009 101.716 53.2453C100.494 53.9478 99.0633 53.8292 98.291 52.5843C96.2067 49.225 99.1916 44.2159 103.035 46.4206" stroke="white" stroke-width="5" stroke-linecap="round"/>
            <path class="eye_right_2" d="M84.3774 38.5474C87.557 38.1741 91.0177 39.7979 91.0507 43.2705C91.0752 45.8546 87.9951 47.7577 85.8573 47.6775C80.9367 47.4929 80.974 36.8566 86.9782 39.032" stroke="white" stroke-width="5" stroke-linecap="round"/>
        </g>
        <g class="eyes_AlertPlus">
            <path class="eye_left_3" d="M105.61 41.608C107.676 43.0199 110.229 46.5626 109.709 49.3645C109.401 51.0288 106.218 52.5065 104.891 53.1391C102.795 54.1391 100.385 53.7601 99.1427 51.611C95.7896 45.8113 101.073 37.9453 107.451 42.0692" stroke="white" stroke-width="7" stroke-linecap="round"/>
            <path class="eye_right_3" d="M83.2791 28.9427C87.8939 28.6482 92.7612 31.2557 92.5425 36.2672C92.3797 39.9965 87.791 42.5052 84.7135 42.2256C77.6302 41.582 78.4996 26.2429 86.9933 29.8412" stroke="white" stroke-width="7" stroke-linecap="round"/>
        </g>
        <g class="eyes_dead">
            <g class="Group 3">
                <path class="Vector 25" d="M93.0814 34.7958C90.2516 35.9261 87.9165 38.317 85.5017 40.1972C83.2384 41.9595 81.1938 44.0075 78.945 45.7862" stroke="white" stroke-width="3" stroke-linecap="round"/>
                <path class="Vector 26" d="M82.6151 32.6597C84.5643 35.2471 85.8653 38.1682 87.2975 41.1368C87.8982 42.3819 88.582 43.5686 89.0424 44.8737" stroke="white" stroke-width="3" stroke-linecap="round"/>
            </g>
            <g class="Group 4">
                <path class="Vector 25_2" d="M108.618 43.0503C106.151 43.5706 103.909 45.1887 101.674 46.3792C99.5796 47.495 97.6227 48.8747 95.5375 50.006" stroke="white" stroke-width="3" stroke-linecap="round"/>
                <path class="Vector 26_2" d="M98.8667 40.7809C100.815 42.9297 102.257 45.4857 103.816 48.0675C104.47 49.1503 105.186 50.1662 105.729 51.3257" stroke="white" stroke-width="3" stroke-linecap="round"/>
            </g>
        </g>
        <path class="mouth_happy" d="M95.1351 62.7138C92.3576 63.7339 90.0222 64.1576 87.3323 63.0378C85.7802 62.3917 84.2997 61.4311 83.0844 60.2388C82.1346 59.3071 81.6607 57.8978 81.1321 56.6643" stroke="white" stroke-width="3" stroke-linecap="round"/>
        <path class="mouth_neutral" d="M82.9225 59.6216C86.3711 60.9506 90.7257 61.5276 93.609 63.5962" stroke="white" stroke-width="3" stroke-linecap="round"/>
    </g>
</svg>`;
}

function getSupineDecubitus(height_px: number, classes: string, bloodStyle: string) {
	return `<svg class="body_picto ${classes}" width="${height_px}" viewBox="0 0 532 214" fill="none" xmlns="http://www.w3.org/2000/svg">
    <g class="backLying_position">
        <path style="${bloodStyle} transform-origin:59% 50%;" class="blood" d="M76.6288 78.8747C116.934 77.2462 156.995 70.4969 196.306 61.5722C197.606 58.1114 197.429 53.0937 198.165 49.4946C200.398 38.58 210.826 41.335 220.781 41.2513C232.24 41.155 243.041 42.6307 254.389 43.5764C279.354 45.6568 304.424 45.2782 329.424 47.0639C351.512 48.6416 379.62 49.0156 398.119 63.4449C416.717 77.9519 424.618 96.4001 422.849 119.986C420.679 148.911 387.297 162.57 363.877 173.99C342.192 184.565 320.64 195.951 297.931 204.216C287.44 208.033 269.734 215.941 257.771 213.516C241.155 210.148 226.932 197.457 210.847 192.168C193.773 186.553 175.606 181.675 157.583 180.754C140.141 179.863 125.803 186.303 109.602 191.322C85.4902 198.792 55.2211 191.742 32.5587 182.128C-6.68248 165.48 -11.4828 106.32 23.7869 82.9964C39.4824 72.6171 59.2992 79.5749 76.6288 78.8747Z" fill="#C40000"/>
        <g class="back_body">
            <path d="M300.437 98.8882C297.185 101.452 290.844 103.296 280.167 104.134C274.452 104.582 263.342 105.636 251.255 106.782C237.3 108.105 222.042 109.552 212.275 110.334C217.468 110.528 222.79 110.631 228.144 110.735C246.445 111.09 265.124 111.453 280.317 115.444C281.766 114.237 286.184 111.66 292.268 111.009C298.352 110.358 318.637 113.409 322.642 119.297L325.306 128.64C324.994 132.062 297.924 131.607 293.941 131.244C289.957 130.881 282.651 126.577 279.495 124.47L176.353 128.821C158.541 125.669 142.903 120.068 132.752 116.432C130.72 115.705 128.908 115.056 127.342 114.521C122.497 112.866 113.882 109.297 106.008 104.309C96.3591 101.478 86.0029 95.6847 86.5159 81.6518C87.5413 53.6016 110.019 40.4597 137.045 39.6356C158.666 38.9763 233.956 46.2692 270.137 50.31C270.149 50.3592 270.162 50.4085 270.175 50.4579C282.374 45.4394 299.879 42.646 312.562 42.1325C329.5 41.4467 366.32 37.2795 382.613 35.2816L474.369 36.1009C479.369 25.4288 490.616 3.42012 495.61 0.761906C500.603 -1.8963 509.805 3.35168 513.782 6.30795L491.014 80.911L463.277 72.446L412.948 72.2068L487.327 87.729C494.317 78.2405 509.651 58.856 515.068 57.2255C520.485 55.595 528.483 62.5411 531.805 66.2179L494.889 134.929L469.343 121.203L387.511 104.482C366.219 103.31 326.915 100.967 300.437 98.8882Z" fill="black"/>
            <path d="M48.4997 39.5788C68.934 39.5035 85.5326 48.4555 85.61 69.4422C85.6874 90.4288 68.2373 104.006 56.7374 104.049C36.303 104.124 14.1953 92.6925 14.1179 71.7058C14.0405 50.7191 28.0653 39.6541 48.4997 39.5788Z" fill="black"/>
        </g>
        <g class="eyes_N-A">
            <path class="eye_left" d="M50.0628 42C50.7376 43.7306 50.7473 45.1423 50.4595 46.9037" stroke="white" stroke-width="3" stroke-linecap="round"/>
            <path class="eye_right" d="M53.2319 69.7877C56.5009 65.2926 54.7166 57.8375 51.3405 55.0537" stroke="white" stroke-width="3" stroke-linecap="round"/>
        </g>
        <g class="eyes_AlertMinus">
            <path class="eye_left_2" d="M45.377 47.5422C45.4163 46.0829 46.3942 43.7103 48.0158 43.0774C48.979 42.7015 50.806 43.7927 51.5762 44.2421C52.7934 44.9526 53.4026 46.2529 52.7071 47.5422C50.8301 51.0216 45 50.9248 45 46.4939" stroke="white" stroke-width="5" stroke-linecap="round"/>
            <path class="eye_right_2" d="M47.454 66.5955C45.5482 64.0232 45.2347 60.2133 48.2305 58.4568C50.4599 57.1498 53.6432 58.8746 54.6373 60.7689C56.9255 65.129 47.6808 70.389 46.5803 64.0984" stroke="white" stroke-width="5" stroke-linecap="round"/>
        </g>
        <g class="eyes_AlertPlus">
            <path class="eye_left_3" d="M42.7462 47.7896C42.823 45.2884 44.4328 41.2292 47.0733 40.1577C48.6418 39.5213 51.6011 41.407 52.8486 42.1839C54.8205 43.4118 55.799 45.6459 54.6575 47.8504C51.5771 53.7995 42.1041 53.5852 42.1428 45.9895" stroke="white" stroke-width="7" stroke-linecap="round"/>
            <path class="eye_right_3" d="M44.1031 73.426C41.3693 69.6965 40.9445 64.1911 45.2848 61.676C48.5145 59.8045 53.0999 62.3194 54.5219 65.0629C57.7949 71.3775 44.4028 78.9071 42.8596 69.8127" stroke="white" stroke-width="7" stroke-linecap="round"/>
        </g>
        <g class="eyes_dead">
            <g class="Group 3">
                <path class="Vector 25" d="M42.0408 58.7471C43.9948 61.0854 46.993 62.5616 49.5307 64.2723C51.9093 65.8757 54.4914 67.1825 56.8811 68.767" stroke="white" stroke-width="3" stroke-linecap="round"/>
                <path class="Vector 26" d="M43.264 69.3589C45.1173 66.702 47.4893 64.5575 49.8657 62.2734C50.8624 61.3154 51.7777 60.2967 52.8751 59.4534" stroke="white" stroke-width="3" stroke-linecap="round"/>
            </g>
            <g class="Group 4">
                <path class="Vector 25_2" d="M45.0569 41.4143C46.3184 43.5972 48.5533 45.2253 50.3794 46.9794C52.0911 48.6234 54.0107 50.0545 55.7342 51.6847" stroke="white" stroke-width="3" stroke-linecap="round"/>
                <path class="Vector 26_2" d="M45.9312 51.3881C47.3679 48.8684 49.349 46.7029 51.3183 44.4191C52.1443 43.4612 52.8871 42.4643 53.8205 41.588" stroke="white" stroke-width="3" stroke-linecap="round"/>
            </g>
        </g>
        <path class="mouth_happy" d="M65.397 50C67.2298 52.3228 68.3585 54.4107 68.1304 57.3156C67.9987 58.9915 67.5459 60.6973 66.7904 62.2231C66.2001 63.4154 65.0079 64.3039 64 65.1898" stroke="white" stroke-width="3" stroke-linecap="round"/>
        <path class="mouth_neutral" d="M68 59.2102C67.0695 55.6334 65 51.7589 65 48.2102" stroke="white" stroke-width="3" stroke-linecap="round"/>
    </g>
</svg>`;
}

function getProneDecubitus(height_px: number, classes: string, bloodStyle: string) {
	return `<svg class="body_picto ${classes}" width="${height_px}" viewBox="0 0 522 200" fill="none" xmlns="http://www.w3.org/2000/svg">
    <g class="ventral_position">
        <path style="${bloodStyle}  transform-origin:50% 43%;" class="blood" d="M77.6288 64.8747C117.934 63.2462 157.995 56.4969 197.306 47.5722C198.606 44.1114 198.429 39.0937 199.165 35.4946C201.398 24.58 211.826 27.335 221.781 27.2513C233.24 27.155 244.041 28.6307 255.389 29.5764C280.354 31.6568 305.424 31.2782 330.424 33.0639C352.512 34.6416 380.62 35.0156 399.119 49.4449C417.717 63.9519 425.618 82.4001 423.849 105.986C421.679 134.911 388.297 148.57 364.877 159.99C343.192 170.565 321.64 181.951 298.931 190.216C288.44 194.033 270.734 201.941 258.771 199.516C242.155 196.148 227.932 183.457 211.847 178.168C194.773 172.553 176.606 167.675 158.583 166.754C141.141 165.863 126.803 172.303 110.602 177.322C86.4902 184.792 56.2211 177.742 33.5587 168.128C-5.68248 151.48 -10.4828 92.3199 24.7869 68.9964C40.4824 58.6171 60.2992 65.5749 77.6288 64.8747Z" fill="#C40000"/>
        <g class="body_ventral">
            <path d="M454.451 63.8731L372.879 62.1522C378.39 61.9439 383.3 61.7804 387.103 61.6681L477.685 47.0079C484.239 56.803 498.679 76.8618 504.017 78.7358C509.354 80.6099 517.659 74.033 521.144 70.5103L487.376 0.19873L461.234 12.7535L378.73 25.7532C356.301 25.9713 313.906 26.5813 287.47 27.5391C283.737 26.1366 278.182 25.2553 270.319 25.0342C264.588 24.8731 253.44 24.3782 241.31 23.8397C225.589 23.1418 208.218 22.3706 198.858 22.1583L198.275 22.1451C176.724 21.6554 139.721 20.8146 110.292 29.8582C109.31 30.1599 107.977 30.47 106.41 30.8347C96.2809 33.1917 76.3544 37.8287 78.0386 57.2016C80.4473 84.9072 103.154 96.9403 129.865 96.6419C132.226 97.4254 134.456 98.1071 136.463 98.674L175.136 103.816C162.413 106.067 148.25 111.687 136.772 116.241C129.926 118.957 124.036 121.294 119.977 122.311C111.131 124.528 106.812 124.735 100.987 125.015C97.8707 125.164 94.3229 125.335 89.4198 125.845C78.1667 127.015 63.5586 143.321 62.5113 150.113C73.9489 146.388 111.205 135.85 120.227 135.651C141.757 135.176 200.862 120.085 232.105 104.887L220.453 92.4606C218.455 90.4634 216.066 88.6131 213.382 86.8963C230.189 84.4567 246.395 81.9657 258.891 79.9581C270.964 85.8287 289.635 89.3939 303.002 90.2816C319.917 91.4048 356.617 96.5221 372.852 98.9404L464.6 100.493C469.322 111.29 479.997 133.582 484.92 136.369C489.843 139.155 499.178 134.147 503.23 131.294L482.397 56.1277L454.451 63.8731Z" fill="black"/>
            <path d="M35.5784 101.984C56.01 101.641 72.4218 92.3509 72.0693 71.3671C71.7169 50.3832 53.9924 37.1658 42.494 37.359C22.0624 37.7021 0.193379 49.5842 0.54583 70.5681C0.898282 91.552 15.1467 102.327 35.5784 101.984Z" fill="black"/>
        </g>
        <g class="eyes_N-A">
            <path class="eye_left" d="M30.0628 97.7877C30.7376 96.0571 30.7473 94.6454 30.4595 92.8839" stroke="white" stroke-width="3" stroke-linecap="round"/>
            <path class="eye_right" d="M33.2319 70C36.5009 74.4951 34.7166 81.9502 31.3405 84.734" stroke="white" stroke-width="3" stroke-linecap="round"/>
        </g>
        <g class="eyes_AlertMinus">
            <path class="eye_left_2" d="M26.377 94.4578C26.4163 95.9171 27.3942 98.2897 29.0158 98.9226C29.979 99.2985 31.806 98.2073 32.5762 97.7579C33.7934 97.0474 34.4026 95.7471 33.7071 94.4578C31.8301 90.9784 26 91.0752 26 95.5061" stroke="white" stroke-width="5" stroke-linecap="round"/>
            <path class="eye_right_2" d="M28.454 75.4045C26.5482 77.9768 26.2347 81.7867 29.2305 83.5432C31.4599 84.8502 34.6432 83.1254 35.6373 81.2311C37.9255 76.871 28.6808 71.611 27.5803 77.9016" stroke="white" stroke-width="5" stroke-linecap="round"/>
        </g>
        <g class="eyes_AlertPlus">
            <path class="eye_left_3" d="M23.7462 94.2762C23.823 96.7774 25.4328 100.837 28.0733 101.908C29.6418 102.545 32.6011 100.659 33.8486 99.882C35.8205 98.6541 36.799 96.4199 35.6575 94.2155C32.5771 88.2664 23.1041 88.4806 23.1428 96.0763" stroke="white" stroke-width="7" stroke-linecap="round"/>
            <path class="eye_right_3" d="M25.1031 68.6399C22.3693 72.3694 21.9445 77.8748 26.2848 80.3898C29.5145 82.2614 34.0999 79.7465 35.5219 77.003C38.7949 70.6883 25.4028 63.1588 23.8596 72.2532" stroke="white" stroke-width="7" stroke-linecap="round"/>
        </g>
        <g class="eyes_dead">
            <g class="Group 3">
                <path class="Vector 25" d="M23.5318 80.2451C25.8146 78.2267 29.0005 77.2174 31.7663 75.907C34.3586 74.6789 37.1077 73.7746 39.7081 72.5669" stroke="white" stroke-width="3" stroke-linecap="round"/>
                <path class="Vector 26" d="M26.3342 69.9372C27.7676 72.8423 29.7908 75.3186 31.7973 77.9335C32.6389 79.0303 33.3908 80.1749 34.3492 81.1734" stroke="white" stroke-width="3" stroke-linecap="round"/>
            </g>
            <g class="Group 4">
                <path class="Vector 25_2" d="M23.9113 97.8343C25.4862 95.8655 27.9402 94.5913 30.009 93.1313C31.9481 91.7629 34.0608 90.6363 36.0095 89.2833" stroke="white" stroke-width="3" stroke-linecap="round"/>
                <path class="Vector 26_2" d="M26.2732 88.1048C27.3153 90.8116 28.9489 93.2499 30.553 95.8036C31.2258 96.8746 31.8105 97.9718 32.6018 98.9782" stroke="white" stroke-width="3" stroke-linecap="round"/>
            </g>
        </g>
        <path class="mouth_happy" d="M46.397 81C48.2298 83.3228 49.3585 85.4107 49.1304 88.3156C48.9987 89.9915 48.5459 91.6973 47.7904 93.2231C47.2001 94.4154 46.0079 95.3039 45 96.1898" stroke="white" stroke-width="3" stroke-linecap="round"/>
        <path class="mouth_neutral" d="M49.0001 82.0001C48.0697 85.5769 46.0001 89.4515 46.0001 93.0001" stroke="white" stroke-width="3" stroke-linecap="round"/>
    </g>
</svg>`;
}

function getRecoveryPosition(height_px: number, classes: string, bloodStyle: string) {
	return `<svg class="body_picto ${classes}" width="${height_px}" viewBox="0 0 558 215" fill="none" xmlns="http://www.w3.org/2000/svg">
    <g class="pls_position">
        <path style="${bloodStyle} transform-origin:50% 40%;" class="blood" d="M76.6288 64.8747C116.934 63.2462 156.995 56.4969 196.306 47.5722C197.606 44.1114 197.429 39.0937 198.165 35.4946C200.398 24.58 210.826 27.335 220.781 27.2513C232.24 27.155 243.041 28.6307 254.389 29.5764C279.354 31.6568 304.424 31.2782 329.424 33.0639C351.512 34.6416 379.62 35.0156 398.119 49.4449C416.717 63.9519 424.618 82.4001 422.849 105.986C420.679 134.911 387.297 148.57 363.877 159.99C342.192 170.565 320.64 181.951 297.931 190.216C287.44 194.033 269.734 201.941 257.771 199.516C241.155 196.148 226.932 183.457 210.847 178.168C193.773 172.553 175.606 167.675 157.583 166.754C140.141 165.863 125.803 172.303 109.602 177.322C85.4902 184.792 55.2211 177.742 32.5587 168.128C-6.68248 151.48 -11.4828 92.3199 23.7869 68.9964C39.4824 58.6171 59.2992 65.5749 76.6288 64.8747Z" fill="#C40000"/>
        <g class="body_pls">
            <path d="M129.613 55.7032C136.232 52.698 141.21 47.0112 143.146 37.6177C145.088 28.1965 142.763 19.6519 138.645 13.1729C134.465 6.59438 128.659 2.46965 124.04 1.51761C114.531 -0.442264 104.168 0.225781 95.7908 3.71913C87.4791 7.18499 81.2737 13.3362 79.3981 22.4365C77.423 32.0193 79.1701 39.6541 83.4324 45.3468C87.7368 51.0958 94.8895 55.2391 104.395 57.1983C114.03 59.1841 122.844 58.7769 129.613 55.7032Z" fill="black"/>
            <path d="M119.788 61.2301C127.623 60.5133 134.46 57.6882 139.324 52.3044L142.547 67.4189L148.018 102.73C148.134 103.479 148.791 104.024 149.55 103.999C150.308 103.974 150.928 103.386 150.994 102.63L150.996 102.607L151.002 102.542C151.006 102.484 151.013 102.4 151.022 102.29C151.039 102.069 151.064 101.742 151.093 101.318C151.151 100.468 151.228 99.2225 151.303 97.633C151.452 94.4542 151.594 89.8964 151.562 84.3665C151.5 73.3474 150.751 58.4427 148.003 42.8873C148.003 42.8415 148.003 42.7954 148.003 42.749C148.001 42.4849 148 42.235 148 42L148 41.9531L148.001 41.8906C148.001 41.8553 148.001 41.82 148.002 41.7847C148.001 40.8056 148 39.719 148 38.5C148 13.7 169 6.27631 176.5 4.49999C199.703 -0.995371 230.387 4.46771 253.112 8.51352C260.161 9.76851 266.444 10.8871 271.5 11.5C280.814 12.6289 298.064 15.1388 313.678 17.4105L313.68 17.4108L313.684 17.4113L315.503 17.676C317.145 18.2921 319.271 18.7148 321.84 18.9914C329.778 19.8463 335.696 21.9723 340.194 24.9188C344.686 27.8616 347.84 31.674 350.179 36.0231C352.528 40.3887 354.054 45.2919 355.276 50.4034C355.886 52.9567 356.416 55.5446 356.938 58.1349L357.128 59.08L357.13 59.0891L357.131 59.0963L357.132 59.1021L357.133 59.1069C357.334 60.1071 357.535 61.1071 357.74 62.1025C357.616 62.0964 357.493 62.0906 357.371 62.0848L357.071 62.071C361.689 79.3447 373.381 127.1 378.993 150.239L489.983 151.726L513.049 146.74L522.104 210.772C519.065 213.732 506.409 218.057 500.106 210.772C493.803 203.487 489.564 183.057 489.635 177.724L354.553 182.915L309.843 86.3073C309.275 85.0521 308.69 83.6862 308.102 82.2294C269.168 85.0633 214.787 88.2289 197 86.9114C191.248 86.4853 185.724 85.4507 180.59 83.7865C180.455 85.2454 180.321 86.686 180.192 88.0945L180.126 88.8207C179.692 93.5556 179.305 97.8961 179.007 101.314C176.349 115.095 165.897 140.019 145.346 129.463C143.227 128.374 141.252 126.734 139.415 124.634C128.958 112.685 122.929 85.8612 119.788 61.2301Z" fill="black"/>
            <path d="M147.251 59.4004C147.215 59.8181 147.176 60.255 147.136 60.713L147.136 60.7143C147.049 61.7048 146.953 62.794 146.848 64C146.589 66.9581 146.38 69.4231 146.211 71.4737L148.566 86.6731C148.568 85.9305 148.567 85.1669 148.562 84.3835C148.522 77.3539 148.2 68.7406 147.251 59.4004Z" fill="black"/>
            <path d="M149.5 102.5L150.994 102.63C150.994 102.631 150.994 102.631 149.5 102.5Z" fill="black"/>
            <path d="M178.432 110.966C176.606 116.13 173.97 121.528 170.424 125.793C167.498 129.314 163.855 132.177 159.428 133.385C154.958 134.605 149.938 134.07 144.432 131.242C142.506 130.253 140.719 128.878 139.057 127.189L138.992 127.65C125.26 125.294 96.8338 119.254 92.9935 113.935C89.1533 108.616 75.6619 97.9842 69.3962 93.3333L75.744 108.792L56.5778 103.077L49.8784 106.297L51.7203 119.368C56.9017 124.739 72.5776 138.154 82.3027 135.791C85.079 135.117 86.6826 133.639 87.9908 132.433C89.8631 130.708 91.1304 129.54 94.3651 132.083C108.905 143.514 146.848 153.513 166.238 153.513C173.403 143.62 176.7 126.933 178.432 110.966Z" fill="black"/>
            <path d="M425.986 68.7631C411.126 66.9647 379.194 63.3893 360.838 62.2733C360.579 61.0269 360.325 59.7653 360.069 58.4909L359.879 57.5429C359.357 54.9515 358.817 52.3168 358.193 49.706C356.946 44.4893 355.348 39.2988 352.821 34.6019C350.286 29.8885 346.814 25.6697 341.838 22.4093C341.042 21.8881 340.21 21.3926 339.339 20.9244C365.614 24.0583 402.685 29.1226 423.071 32.0003L506.592 31.4719L534.316 22.9632L557.201 97.5304C553.229 100.493 544.035 105.755 539.037 103.105C534.04 100.455 522.758 78.4637 517.741 67.7995L425.986 68.7631Z" fill="black"/>
        </g>
        <g class="eyes_dead">
            <g class="exe_right">
                <path class="Vector 25" d="M97.5316 40.245C99.8145 38.2265 103 37.2172 105.766 35.9069C108.359 34.6788 111.108 33.7745 113.708 32.5668" stroke="white" stroke-width="3" stroke-linecap="round"/>
                <path class="Vector 26" d="M100.334 29.9371C101.768 32.8421 103.791 35.3184 105.797 37.9334C106.639 39.0302 107.391 40.1748 108.349 41.1733" stroke="white" stroke-width="3" stroke-linecap="round"/>
            </g>
            <g class="eye_left">
                <path class="Vector 25_2" d="M97.9113 57.8342C99.4862 55.8654 101.94 54.5913 104.009 53.1313C105.948 51.7628 108.061 50.6362 110.009 49.2832" stroke="white" stroke-width="3" stroke-linecap="round"/>
                <path class="Vector 26_2" d="M100.273 48.1047C101.315 50.8115 102.949 53.2499 104.553 55.8035C105.226 56.8745 105.81 57.9717 106.602 58.9781" stroke="white" stroke-width="3" stroke-linecap="round"/>
            </g>
        </g>
        <g class="eyes_N-A">
            <path class="eye_left_2" d="M107.063 54.7876C107.738 53.057 107.747 51.6453 107.46 49.8839" stroke="white" stroke-width="3" stroke-linecap="round"/>
            <path class="eye_right" d="M110.232 27C113.501 31.4951 111.717 38.9501 108.341 41.7339" stroke="white" stroke-width="3" stroke-linecap="round"/>
        </g>
        <g class="eyes_AlertMinus">
            <path class="eye_left_3" d="M103.377 51.4578C103.416 52.9171 104.394 55.2897 106.016 55.9226C106.979 56.2985 108.806 55.2073 109.576 54.7579C110.793 54.0474 111.403 52.7471 110.707 51.4578C108.83 47.9784 103 48.0752 103 52.5061" stroke="white" stroke-width="5" stroke-linecap="round"/>
            <path class="eye_right_2" d="M105.454 32.4045C103.548 34.9768 103.235 38.7867 106.231 40.5432C108.46 41.8502 111.643 40.1254 112.637 38.2311C114.926 33.871 105.681 28.611 104.58 34.9016" stroke="white" stroke-width="5" stroke-linecap="round"/>
        </g>
        <g class="eyes_AlertPlus">
            <path class="eye_left_4" d="M98.6126 49.2134C98.6765 51.715 100.266 55.7824 102.901 56.8673C104.466 57.5117 107.435 55.6411 108.686 54.8706C110.664 53.6528 111.654 51.4236 110.524 49.2134C107.474 43.2487 98 43.4146 98 51.0104" stroke="white" stroke-width="7" stroke-linecap="round"/>
            <path class="eye_right_3" d="M100.1 23.5843C97.3473 27.2998 96.8945 32.803 101.222 35.3401C104.442 37.2281 109.04 34.7367 110.476 32.0004C113.781 25.7025 100.428 18.1048 98.8382 27.1912" stroke="white" stroke-width="7" stroke-linecap="round"/>
        </g>
        <path class="mouth_happy" d="M124.397 37C126.23 39.3228 127.359 41.4107 127.13 44.3156C126.999 45.9915 126.546 47.6973 125.79 49.2231C125.2 50.4154 124.008 51.3039 123 52.1898" stroke="white" stroke-width="3" stroke-linecap="round"/>
        <path class="mouth_neutral" d="M123 42.7876C122.379 45.7141 121 48.8842 121 51.7876" stroke="white" stroke-width="3" stroke-linecap="round"/>
     </g>
	</svg>`;
}


function getPainIcon(pain: number, overview: HumanOverview): string {
	if (overview.looksDead || overview.gcs.total < 13) {
		return "/patient/pain/sleepy_face.png";
	}

	if (pain <= 2) {
		return "/patient/pain/no_pain.png";
	} else if (pain <= 4) {
		return "/patient/pain/low_pain.png";
	} else if (pain <= 6) {
		return "/patient/pain/mild_pain.png";
	} else if (pain <= 8) {
		return "/patient/pain/high_pain.png";
	} else {
		return "/patient/pain/horrible_pain.png";
	}
}

export function getMouth(cyanosis: boolean) {
	const color = cyanosis ? "#3E8BFF" : '#FF4458';
	return `<svg width="83" height="47" viewBox="0 0 83 47" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M81.8652 22.5333C81.0709 21.8155 79.5795 21.5372 78.7041 21.2003C75.008 19.7794 73.8408 18.0509 70.5662 15.9415C67.0322 13.6564 64.0494 10.7413 60.1263 8.95421C56.3005 7.21104 52.0209 6.90343 47.9519 8.1339C45.9742 8.73448 44.1099 9.62804 42.3754 10.6534C41.8404 10.9757 41.1433 11.0196 40.5759 10.756C38.9062 9.9796 35.7127 8.30968 35.0966 8.1339C25.5322 5.24815 19.5341 11.4005 12.4824 15.9415C9.20778 18.0509 8.02438 19.7794 4.3445 21.2003C3.40427 21.5665 1.91286 21.8009 1.16716 22.5187C0.583565 23.0753 0.599776 23.5733 0.599776 24.1446C0.599776 28.0118 11.7691 45.004 41.4675 45.004C71.166 45.004 82.3515 27.9532 82.3515 24.2179C82.3515 23.9835 82.4164 23.0314 81.8652 22.5333Z" fill="${color}"/>
<path d="M2.64238 24.9502C3.50156 24.9941 4.36074 25.0234 5.23613 24.9502L7.82988 24.8477C8.68906 24.833 9.54824 24.7451 10.4236 24.6865L13.0498 24.5107C13.9252 24.4521 14.7682 24.3496 15.6273 24.2764C16.4865 24.1885 17.3457 24.1299 18.1887 24.0127C19.0479 23.9102 19.8908 23.8369 20.75 23.6904C21.593 23.5586 22.4359 23.4414 23.2951 23.2949L25.8727 22.8701C26.748 22.7383 27.6721 22.6064 28.6123 22.5332L29.3256 22.4893L29.6822 22.4746L29.8605 22.46H30.1523L31.4654 22.5186C31.66 22.5186 31.968 22.5771 32.2273 22.6211C32.5029 22.665 32.7785 22.7236 33.0541 22.7822C33.6215 22.8848 34.0268 23.0752 34.5131 23.2217C34.967 23.3828 35.3561 23.5439 35.7775 23.7051L36.8961 24.1152L37.9822 24.4082C38.3551 24.4814 38.7279 24.5254 39.1008 24.584C39.4574 24.6572 39.8627 24.6572 40.2518 24.6719L40.8354 24.7012L41.1271 24.7158H41.3865C41.1758 24.7451 41.8729 24.6572 40.9164 24.7744L40.9488 24.7598L41.1596 24.7158L41.4189 24.7012C42.035 24.6719 43.2021 24.6719 43.8506 24.5693L44.8881 24.4082L45.9742 24.1152L47.0928 23.7197C47.5143 23.5586 47.9033 23.3975 48.3572 23.2363C49.265 22.9141 50.2863 22.6504 51.3238 22.5479L52.8477 22.4746H53.0908L53.2529 22.4893L53.5771 22.5039L54.2256 22.5479C55.0686 22.6064 56.1547 22.7529 56.9977 22.8848L59.5914 23.2949C60.4506 23.4561 61.2936 23.5586 62.1365 23.6904C62.9795 23.8369 63.8387 23.8955 64.6978 24.0127C65.557 24.1299 66.4162 24.1885 67.2754 24.2764C68.9938 24.4668 70.7283 24.584 72.4629 24.6865L73.7598 24.7891L74.084 24.8184H74.3758L75.0404 24.8477L77.6666 24.9502C78.5582 25.0234 79.4012 24.9795 80.2604 24.9502C81.1357 24.9502 81.2006 25.2871 80.3414 25.4482C79.466 25.6387 78.5744 25.7998 77.7152 25.873L75.1053 26.1367L74.4568 26.1953L74.2947 26.21L74.1002 26.2246L73.776 26.2393L72.4629 26.3125C70.6959 26.3857 68.9289 26.4443 67.1619 26.4443C66.2703 26.459 65.3949 26.4443 64.5033 26.4004C63.6117 26.3564 62.7201 26.3418 61.8285 26.2685C60.0615 26.1514 58.2459 25.9609 56.56 25.7559C55.6684 25.668 55.0037 25.5947 54.1121 25.5654L53.4637 25.5508H52.8963L51.7939 25.6533C51.4373 25.6973 51.0969 25.8144 50.7564 25.8584C50.416 25.9316 50.0594 26.0928 49.7027 26.1953C49.3299 26.3271 48.9246 26.5029 48.5518 26.6494L47.2387 27.1475L45.8121 27.5576C45.3096 27.6602 44.7908 27.7334 44.2721 27.8213C43.7209 27.9238 43.3318 27.9238 42.8779 27.9531L42.2295 27.9971L41.9053 28.0117L41.7432 28.0264H41.5486L41.4676 28.0117L41.9539 27.9531L41.9215 27.9678C40.965 28.085 41.6459 27.9971 41.4352 28.0264H41.3055L41.1271 28.0117L40.7705 27.9971L40.0572 27.9531C39.5709 27.9238 39.1008 27.9092 38.6145 27.8066C38.1281 27.7187 37.6418 27.6601 37.1555 27.543L35.7289 27.1328L34.4158 26.6348C34.0268 26.4883 33.6215 26.3125 33.2648 26.1807C32.9244 26.0781 32.5354 25.9023 32.2436 25.8584C32.0977 25.8291 31.9355 25.7998 31.7896 25.7559C31.6275 25.7119 31.5141 25.668 31.2709 25.6533L29.9578 25.5361L28.8717 25.5508C28.0611 25.5654 27.2506 25.6533 26.3914 25.7412C24.7055 25.9463 22.9061 26.1367 21.1391 26.2539C20.2475 26.3271 19.3559 26.3418 18.4805 26.3857C17.5889 26.4297 16.6973 26.4443 15.8057 26.4297C14.0225 26.4443 12.2717 26.3857 10.5209 26.2978C9.66172 26.2539 8.75391 26.2246 7.87852 26.1221L5.23613 25.8584C4.36074 25.7852 3.48535 25.624 2.60996 25.4336C1.70215 25.2725 1.75078 24.9355 2.64238 24.9502Z" fill="black"/>
</svg>`
}


/**
 *	
 */
function convertMeterToPixel(m: number, resolution: number){
	return m / resolution;
}

export function getBodyPicto(overview: HumanOverview, resolution: number = 0.05): string {
	const { className, bloodRatio } = getPicoClassNames(overview);

	const bloodStyle = `transform: scale(${bloodRatio});`;

	const height = convertMeterToPixel(overview.height_cm / 100, resolution);

	switch (overview.position) {
		case 'STANDING':
			return getStanding(height, className, bloodStyle);
		case 'SITTING':
			return getSitting(height, className, bloodStyle);
		case 'SUPINE_DECUBITUS':
			return getSupineDecubitus(height, className, bloodStyle);
		case 'PRONE_DECUBITUS':
			return getProneDecubitus(height, className, bloodStyle);
		case 'RECOVERY':
			return getRecoveryPosition(height, className, bloodStyle);
	}
}



export const colorfulModel: Point[] = [
	{ x: 0.6, y: 0 },
	{ x: 0.85, y: 1 }
]


function getColorful(human: HumanBody) {
	const bloodRatio = human.state.vitals.cardio.totalVolume_mL / human.meta.initialBloodVolume_mL;

	return interpolate(bloodRatio, colorfulModel);
}


export function getOverview(human: (HumanBody & { category: Categorization | undefined })): HumanOverview {

	

	const looksDead = (human.state.vitals.cardiacArrest ?? 0) > 0;

	const category = getCategory(human.category?.category);

	return {
		height_cm: human.meta.height_cm,
		gcs: human.state.vitals.glasgow,
		position: human.state.variables.bodyPosition,
		colorful: looksDead ? 0 : getColorful(human),
		cyanosis: human.state.vitals.respiration.SaO2 < 0.85,
		looksDead: looksDead,
		totalExternalBloodLosses_ml: human.state.vitals.cardio.totalExtLosses_ml,
		category: category?.category,
		rr: human.state.vitals.respiration.rr,
		tidalVolume_L: human.state.vitals.respiration.tidalVolume_L,
	};
}

export function getCategoryCard(): string {
	const id = I18n.toString(Variable.find(gameModel, 'currentPatient'));

	let output: string[] = [''];

	const human = getHuman(id);
	if (human != null) {
		const overview = getOverview(human);
		if (overview) {
			output.push(`<div class='cat_card ${overview.category}' style='background-color:${overview.category?.bgColor}'></div>`);
		}
	} else {
		output.push("<em>Error [patient not found]</em>");
	}
	return output.join("");
}

export function getVisualOverview(): string {
	const id = I18n.toString(Variable.find(gameModel, 'currentPatient'));

	let output: string[] = [''];

	const human = getHuman(id);
	if (human != null) {
		const overview = getOverview(human);
		if (overview) {
			output.push(`<div>${getBodyPicto(overview, 0.005)}</div>`);
		}
	} else {
		output.push("<em>Error [patient not found]</em>");
	}
	return output.join("");
} 

export function getVisualOverviewForHumanId(id: string, resolution: number = 0.05): string {

	let output : string[] = [];

	const human = getHuman(id);
	if (human != null) {
		const overview = getOverview(human);
		if (overview) {
			output.push(getBodyPicto(overview, resolution/4));
		}
	}
	return output.join("");
}

function getCyanosisPos(cyanosis: boolean, pallor: number): number {
	let pos = 50;
	if (cyanosis) {
		pos += (pallor * 0.5);
	}
	else {
		pos -= (pallor * 0.5);
	}
	return pos * .8;
}
export function getVisualDetails(): string {

	let output: string[] = [];

	const human = getCurrentPatientBody();
	if (human != null) {
		const overview = getOverview(human);
		if (overview) {
			const painPath = getPainIcon(human.state.vitals.pain, overview);
			const painURL = Helpers.getFilePath(painPath);
			output.push(`<div class='visualDetail_elem'><p>Pain</p><img width="48px" src='${painURL}' style='display: block'></div>`);
			const cursorPalor = (overview.colorful * 100 * 0.8) + 5;
			const cursorCyan = getCyanosisPos(overview.cyanosis, (overview.colorful * 100)) + 5;
			output.push(`<div class='visualDetail_elem'><p>Coloration</p><div class='coloration_triangle'><div class='cyanosis'><div class='pallor'><div class='coloration_cursor' style='left:${cursorPalor}%; top:${cursorCyan}%'></div></div></div></div></div>`);
		}
	}
	return output.join("");
}



export function getShadowMan() {
	// <svg width="482" height="649" viewBox="0 0 482 649" fill="none" xmlns="http://www.w3.org/2000/svg">
	//<path d="M386.415 324.936C383.439 323.051 379.766 321.025 373.387 314.006C369.56 309.816 364.264 306.883 358.697 304.962C357.692 304.613 356.609 304.299 355.72 303.705C353.903 302.518 353.594 300.073 353.091 298.222C352.589 296.407 352.202 294.521 351.661 292.705C350.579 289.038 349.573 283.207 349.573 273.464C349.573 250.382 344.316 230.442 341.532 225.065C338.749 219.687 336.971 215.566 333.723 193.741C330.437 171.916 336.739 175.513 333.723 149.148C330.708 122.783 308.286 118.139 298.235 116.043C288.183 113.948 267.656 106.301 263.674 103.542C261.702 102.18 261.393 83.3008 261.586 76.7009C264.64 72.4406 266.225 66.8184 267.346 61.9296C267.81 62.4883 268.815 63.501 269.743 63.5708C270.98 63.6407 272.836 60.1137 273.377 58.1931C273.957 56.2725 274.73 49.7773 273.841 47.3329C272.99 44.8885 270.942 46.8091 270.284 47.752C270.052 48.1012 269.55 48.4154 269.009 48.6948C269.202 45.4821 269.357 42.2695 269.898 39.0917C270.903 32.8061 270.439 26.7649 268.081 20.6887C263.132 7.94285 243.687 7.06984 241.02 7C238.314 7.06984 218.907 7.94285 213.92 20.7586C211.562 26.8347 211.098 32.8759 212.103 39.1616C212.605 42.3393 212.799 45.552 212.992 48.7646C212.451 48.4853 211.948 48.171 211.716 47.8218C211.059 46.8789 209.01 44.9583 208.16 47.4028C207.309 49.8472 208.082 56.3423 208.624 58.263C209.203 60.1836 211.02 63.7454 212.257 63.6407C213.185 63.5708 214.19 62.5581 214.654 61.9994C215.775 66.8883 217.36 72.5104 220.415 76.7707C220.608 83.4056 220.299 102.285 218.327 103.612C214.345 106.336 193.817 113.983 183.766 116.113C173.715 118.208 151.331 122.853 148.277 149.218C145.262 175.583 151.563 171.986 148.277 193.811C144.991 215.636 143.252 219.757 140.468 225.134C137.685 230.512 132.427 250.452 132.427 273.534C132.427 283.277 131.422 289.108 130.34 292.775C129.798 294.591 129.412 296.442 128.909 298.292C128.407 300.143 128.097 302.588 126.28 303.775C125.391 304.334 124.347 304.683 123.304 305.032C117.737 306.953 112.441 309.886 108.613 314.076C102.235 321.095 98.6007 323.121 95.5853 325.006C92.6086 326.892 93.5751 331.711 100.418 330.279C107.26 328.848 111.783 321.025 113.484 321.514C115.185 321.968 111.629 333.597 110.198 337.508C108.768 341.419 107.415 346.133 106.526 348.543C105.637 350.952 104.631 355.352 106.642 357.796C108.652 360.241 111.513 357.098 113.484 350.777C115.456 344.492 119.515 333.247 119.515 333.247C119.515 333.247 117.273 342.746 115.611 348.473C113.948 354.235 109.696 361.568 113.33 364.327C115.263 365.793 117.505 363.942 118.781 361.149C120.056 358.355 121.68 353.676 121.796 353.222C122.994 348.543 126.551 335.622 126.551 335.622C126.551 335.622 124.27 346.447 122.917 351.581C122.183 354.444 120.404 358.181 120.404 360.485C120.404 362.301 121.989 363.558 124.077 362.965C125.971 362.441 127.633 358.635 128.755 354.584C129.876 350.428 131.577 342.886 132.62 339.324C133.007 337.962 133.664 336.635 133.626 337.647C133.548 339.847 131.654 345.819 131.035 348.822C130.262 352.628 130.417 355.317 132.388 355.527C133.626 355.666 134.708 355.387 135.79 353.711C137.028 351.79 138.226 346.762 139.115 343.2C140.545 337.438 142.478 332.13 143.329 326.962C144.141 321.794 145.339 311.213 146.228 307.756C147.117 304.299 148.934 299.759 148.934 299.759H148.818C152.298 290.016 160.687 266.62 166.138 252.337C173.135 234.004 170.699 227.684 171.743 219.757C172.439 214.623 178.392 201.773 182.722 188.014C182.722 188.014 195.982 218.569 191.923 236.518C184.848 268.051 187.052 258.867 184.848 268.051C182.413 278.178 179.939 288.096 178.856 298.467C176.382 321.584 174.449 345.016 178.508 367.888C179.977 376.234 185.351 424.599 185.042 426.24C183.766 432.526 179.668 445.726 178.083 453.164C176.498 460.602 177.31 471.776 177.929 492.1C178.547 512.423 181.408 528.172 182.374 539.347C183.186 548.95 181.64 573.429 181.176 580.169C181.099 581.356 180.867 582.508 180.441 583.626C179.514 586.105 178.083 589.562 176.343 592.565C173.251 597.908 166.138 608 163.779 610.13C161.421 612.261 157.594 617.429 161.151 618.93C162.426 619.454 163.045 618.93 163.045 618.93C162.581 620.606 163.393 622.387 164.514 622.911C165.442 623.33 166.601 623.19 166.601 623.19C166.717 624.517 168.38 626.962 171.936 626.089C171.936 626.089 172.826 628.952 175.609 629.092C176.537 629.127 177.426 629.092 178.276 628.813C179.05 628.533 179.9 627.73 180.867 625.74C180.867 625.74 180.171 628.324 183.65 629.546C187.168 630.768 191.304 629.336 193.431 625.251C195.557 621.165 195.325 620.432 197.103 616.905C198.882 613.378 198.07 604.159 199.345 600.388C200.66 596.651 204.448 595.359 204.796 592.251C205.028 590.4 205.106 586.838 204.603 583.451C204.68 583.451 204.835 569.448 204.835 569.448L205.299 563.198C205.995 553.56 207.309 543.922 209.319 534.423C212.683 518.465 217.36 492.03 218.791 476.002C220.685 454.526 222.927 436.472 224.164 433.05C224.203 432.91 224.319 432.666 224.396 432.421C229.113 419.291 232.476 405.742 234.177 392.018C234.718 387.688 235.221 382.904 235.607 377.736C237.347 355.143 236.535 342.851 241.02 342.257C245.504 342.851 244.692 355.143 246.432 377.736C246.818 382.869 247.321 387.653 247.862 392.018C249.563 405.742 252.927 419.291 257.643 432.421C257.759 432.7 257.836 432.91 257.875 433.05C259.151 436.472 261.354 454.526 263.248 476.002C264.679 492.03 269.357 518.465 272.72 534.423C274.73 543.922 276.044 553.525 276.74 563.198L277.204 569.448C277.204 569.448 277.359 583.451 277.436 583.451C276.972 586.804 277.05 590.366 277.243 592.251C277.591 595.359 281.379 596.651 282.694 600.388C284.008 604.124 283.158 613.343 284.936 616.905C286.714 620.432 286.482 621.2 288.609 625.251C290.735 629.336 294.91 630.768 298.389 629.546C301.907 628.324 301.173 625.74 301.173 625.74C302.1 627.73 302.951 628.533 303.763 628.813C304.613 629.127 305.502 629.162 306.43 629.092C309.175 628.952 310.103 626.089 310.103 626.089C313.659 626.962 315.322 624.517 315.438 623.19C315.438 623.19 316.598 623.295 317.525 622.911C318.646 622.422 319.497 620.641 318.994 618.93C318.994 618.93 319.652 619.419 320.889 618.93C324.484 617.464 320.657 612.295 318.26 610.13C315.902 608 308.788 597.908 305.696 592.565C303.956 589.562 302.526 586.07 301.598 583.626C301.173 582.508 300.941 581.356 300.863 580.169C300.399 573.429 298.853 548.915 299.665 539.347C300.631 528.172 303.454 512.423 304.111 492.1C304.729 471.776 305.541 460.602 303.956 453.164C302.371 445.726 298.235 432.561 296.998 426.24C296.65 424.564 302.023 376.234 303.531 367.888C307.59 344.981 305.657 321.584 303.183 298.467C302.062 288.131 299.626 278.178 297.191 268.051C294.987 258.867 297.191 268.051 290.116 236.518C286.096 218.569 299.317 188.014 299.317 188.014C303.647 201.773 309.6 214.623 310.296 219.757C311.34 227.649 308.904 234.004 315.902 252.337C321.353 266.585 329.742 289.981 333.221 299.724H333.105C333.105 299.724 334.922 304.264 335.811 307.721C336.7 311.178 337.898 321.759 338.71 326.927C339.522 332.095 341.494 337.403 342.924 343.165C343.813 346.727 345.012 351.755 346.249 353.676C347.331 355.352 348.414 355.631 349.651 355.492C351.622 355.282 351.777 352.593 351.004 348.787C350.385 345.784 348.491 339.778 348.414 337.613C348.375 336.6 349.032 337.927 349.419 339.289C350.463 342.851 352.164 350.393 353.285 354.549C354.406 358.6 356.068 362.441 357.962 362.93C360.089 363.488 361.635 362.266 361.635 360.45C361.635 358.146 359.857 354.409 359.122 351.546C357.769 346.412 355.488 335.587 355.488 335.587C355.488 335.587 359.045 348.473 360.243 353.187C360.359 353.641 361.944 358.32 363.259 361.114C364.534 363.873 366.815 365.758 368.71 364.292C372.343 361.533 368.091 354.165 366.429 348.438C364.766 342.711 362.524 333.213 362.524 333.213C362.524 333.213 366.583 344.457 368.555 350.743C370.526 357.028 373.387 360.206 375.397 357.762C377.408 355.317 376.403 350.882 375.513 348.508C374.624 346.098 373.233 341.419 371.841 337.473C370.411 333.562 366.893 321.933 368.555 321.479C370.256 321.025 374.779 328.848 381.622 330.244C388.464 331.641 389.431 326.857 386.454 324.971L386.415 324.936Z" fill="#AAAAAA"/>
	//</svg>

	return `<svg viewBox="0 0 294 636" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M292.368 324.587C289.392 322.662 285.72 320.595 279.342 313.429C275.516 309.151 270.221 306.156 264.655 304.195C263.65 303.839 262.568 303.518 261.679 302.912C259.862 301.7 259.553 299.204 259.05 297.315C258.548 295.461 258.162 293.536 257.62 291.682C256.538 287.938 255.533 281.985 255.533 272.038C255.533 248.473 250.277 228.116 247.494 222.626C244.711 217.136 242.933 212.929 239.686 190.647C236.401 168.366 242.701 172.038 239.686 145.121C236.671 118.205 214.254 113.464 204.204 111.325C194.155 109.185 173.631 101.378 169.65 98.5615C167.679 97.1712 167.369 77.8969 167.563 71.1589C170.616 66.8095 172.201 61.0698 173.322 56.0787C173.785 56.6491 174.79 57.6829 175.718 57.7542C176.955 57.8255 178.81 54.2248 179.351 52.264C179.931 50.3032 180.704 43.6722 179.815 41.1766C178.965 38.6811 176.916 40.6419 176.259 41.6044C176.027 41.961 175.525 42.2818 174.984 42.567C175.177 39.2871 175.332 36.0073 175.873 32.7631C176.878 26.3459 176.414 20.1783 174.056 13.9751C169.109 0.962571 149.667 0.0713015 147 0C144.294 0.0713015 124.891 0.962571 119.905 14.0464C117.548 20.2496 117.084 26.4172 118.089 32.8344C118.591 36.0786 118.784 39.3584 118.978 42.6383C118.437 42.3531 117.934 42.0322 117.702 41.6757C117.045 40.7132 114.997 38.7524 114.146 41.2479C113.296 43.7435 114.069 50.3745 114.61 52.3353C115.19 54.2961 117.006 57.9325 118.243 57.8255C119.171 57.7542 120.176 56.7204 120.64 56.15C121.761 61.1411 123.345 66.8808 126.399 71.2302C126.592 78.0039 126.283 97.2781 124.312 98.6328C120.331 101.414 99.8066 109.221 89.7572 111.396C79.7079 113.535 57.3287 118.276 54.2752 145.193C51.2604 172.109 57.5606 168.437 54.2752 190.719C50.9899 213.001 49.2505 217.207 46.4676 222.697C43.6847 228.188 38.4281 248.544 38.4281 272.109C38.4281 282.056 37.4232 288.01 36.341 291.753C35.7998 293.607 35.4133 295.496 34.9109 297.386C34.4084 299.275 34.0992 301.771 32.2826 302.983C31.3936 303.553 30.35 303.91 29.3064 304.266C23.7406 306.227 18.4454 309.222 14.6189 313.5C8.24137 320.666 4.60814 322.734 1.59333 324.659C-1.38283 326.584 -0.416547 331.504 6.42476 330.042C13.2661 328.58 17.7883 320.594 19.4889 321.094C21.1896 321.557 17.6337 333.429 16.2036 337.422C14.7735 341.415 13.4207 346.227 12.5317 348.687C11.6427 351.147 10.6378 355.639 12.6476 358.135C14.6575 360.63 17.5177 357.422 19.4889 350.969C21.4602 344.552 25.5186 333.072 25.5186 333.072C25.5186 333.072 23.2768 342.769 21.6148 348.616C19.9528 354.498 15.7011 361.985 19.3343 364.801C21.2669 366.299 23.5087 364.409 24.7842 361.557C26.0597 358.705 27.683 353.928 27.799 353.464C28.9972 348.687 32.5531 335.497 32.5531 335.497C32.5531 335.497 30.2727 346.548 28.9199 351.789C28.1855 354.712 26.4075 358.527 26.4075 360.88C26.4075 362.734 27.9923 364.017 30.0794 363.411C31.9734 362.876 33.6354 358.99 34.7563 354.855C35.8771 350.612 37.5778 342.912 38.6214 339.276C39.0079 337.885 39.665 336.53 39.6263 337.564C39.549 339.81 37.6551 345.907 37.0367 348.972C36.2637 352.858 36.4183 355.604 38.3895 355.817C39.6263 355.96 40.7086 355.675 41.7908 353.964C43.0277 352.003 44.2259 346.869 45.1148 343.233C46.5449 337.35 48.4775 331.931 49.3278 326.655C50.1395 321.379 51.3377 310.577 52.2267 307.047C53.1157 303.518 54.9323 298.883 54.9323 298.883H54.8163C58.295 288.937 66.6823 265.051 72.1322 250.469C79.1281 231.753 76.6931 225.3 77.7366 217.207C78.4324 211.967 84.3847 198.847 88.7137 184.801C88.7137 184.801 101.971 215.995 97.9127 234.32C90.8395 266.512 93.0426 257.136 90.8395 266.512C88.4044 276.851 85.9307 286.976 84.8485 297.564C82.3748 321.165 80.4422 345.087 84.5006 368.438C85.9694 376.958 91.3419 426.335 91.0327 428.01C89.7572 434.427 85.6602 447.903 84.0755 455.497C82.4908 463.091 83.3024 474.499 83.9209 495.248C84.5393 515.996 87.3995 532.075 88.3658 543.483C89.1775 553.287 87.6314 578.278 87.1676 585.159C87.0903 586.371 86.8584 587.547 86.4332 588.688C85.5056 591.219 84.0755 594.749 82.3362 597.815C79.244 603.269 72.1322 613.573 69.7744 615.747C67.4167 617.922 63.5902 623.198 67.1462 624.731C68.4217 625.266 69.0401 624.731 69.0401 624.731C68.5763 626.442 69.3879 628.261 70.5088 628.795C71.4365 629.223 72.596 629.081 72.596 629.081C72.712 630.435 74.374 632.931 77.9299 632.04C77.9299 632.04 78.8189 634.963 81.6018 635.106C82.5294 635.141 83.4184 635.106 84.2687 634.82C85.0418 634.535 85.8921 633.715 86.8584 631.683C86.8584 631.683 86.1627 634.321 89.6413 635.569C93.1586 636.817 97.2943 635.355 99.4201 631.184C101.546 627.013 101.314 626.264 103.092 622.663C104.87 619.063 104.058 609.651 105.334 605.801C106.648 601.986 110.436 600.667 110.784 597.494C111.016 595.605 111.093 591.968 110.59 588.51C110.668 588.51 110.822 574.214 110.822 574.214L111.286 567.833C111.982 557.993 113.296 548.153 115.306 538.456C118.669 522.164 123.345 495.176 124.775 478.813C126.669 456.887 128.911 438.456 130.148 434.962C130.187 434.82 130.303 434.57 130.38 434.32C135.095 420.916 138.458 407.083 140.159 393.073C140.7 388.652 141.202 383.768 141.589 378.491C143.328 355.425 142.516 342.876 147 342.27C151.484 342.876 150.672 355.425 152.411 378.491C152.798 383.732 153.3 388.616 153.841 393.073C155.542 407.083 158.905 420.916 163.62 434.32C163.736 434.606 163.813 434.82 163.852 434.962C165.128 438.456 167.331 456.887 169.225 478.813C170.655 495.176 175.332 522.164 178.694 538.456C180.704 548.153 182.018 557.957 182.714 567.833L183.178 574.214C183.178 574.214 183.332 588.51 183.41 588.51C182.946 591.932 183.023 595.569 183.216 597.494C183.564 600.667 187.352 601.986 188.666 605.801C189.98 609.615 189.13 619.027 190.908 622.663C192.686 626.264 192.454 627.048 194.58 631.184C196.706 635.355 200.88 636.817 204.359 635.569C207.876 634.321 207.142 631.683 207.142 631.683C208.069 633.715 208.92 634.535 209.731 634.82C210.582 635.141 211.471 635.177 212.398 635.106C215.142 634.963 216.07 632.04 216.07 632.04C219.626 632.931 221.288 630.435 221.404 629.081C221.404 629.081 222.564 629.188 223.491 628.795C224.612 628.296 225.462 626.478 224.96 624.731C224.96 624.731 225.617 625.23 226.854 624.731C230.448 623.234 226.622 617.958 224.226 615.747C221.868 613.573 214.756 603.269 211.664 597.815C209.925 594.749 208.494 591.184 207.567 588.688C207.142 587.547 206.91 586.371 206.832 585.159C206.369 578.278 204.823 553.251 205.634 543.483C206.601 532.075 209.422 515.996 210.079 495.248C210.698 474.499 211.509 463.091 209.925 455.497C208.34 447.903 204.204 434.463 202.967 428.01C202.619 426.299 207.992 376.958 209.499 368.438C213.558 345.051 211.625 321.165 209.152 297.564C208.031 287.012 205.596 276.851 203.161 266.512C200.957 257.136 203.161 266.512 196.087 234.32C192.068 215.995 205.286 184.801 205.286 184.801C209.615 198.847 215.568 211.967 216.263 217.207C217.307 225.264 214.872 231.753 221.868 250.469C227.318 265.015 235.705 288.901 239.184 298.848H239.068C239.068 298.848 240.884 303.482 241.773 307.012C242.662 310.541 243.86 321.343 244.672 326.619C245.484 331.896 247.455 337.315 248.885 343.197C249.774 346.833 250.972 351.967 252.209 353.928C253.291 355.639 254.374 355.924 255.611 355.782C257.582 355.568 257.736 352.823 256.963 348.937C256.345 345.871 254.451 339.739 254.374 337.529C254.335 336.495 254.992 337.849 255.379 339.24C256.422 342.876 258.123 350.577 259.244 354.819C260.365 358.955 262.027 362.876 263.921 363.375C266.046 363.946 267.592 362.698 267.592 360.844C267.592 358.491 265.815 354.677 265.08 351.753C263.727 346.513 261.447 335.461 261.447 335.461C261.447 335.461 265.003 348.616 266.201 353.429C266.317 353.892 267.902 358.67 269.216 361.522C270.491 364.338 272.772 366.263 274.666 364.766C278.299 361.949 274.047 354.427 272.385 348.58C270.723 342.734 268.481 333.037 268.481 333.037C268.481 333.037 272.54 344.516 274.511 350.933C276.482 357.35 279.342 360.595 281.352 358.099C283.362 355.604 282.357 351.076 281.468 348.652C280.579 346.192 279.188 341.415 277.796 337.386C276.366 333.393 272.849 321.521 274.511 321.058C276.212 320.595 280.734 328.58 287.575 330.006C294.417 331.432 295.383 326.548 292.407 324.623L292.368 324.587Z" fill="#AAAAAA"/>
</svg>`;
}


interface LocalizedBlocks {
	localized: {
		blockName: string;
		svg: string;
	}[];
	not_localized: string[];
}

function getBlockZone(blockName: BlockName): string | undefined {
	switch (blockName) {
		case 'HEAD':
			return `<rect x="75" y="-5" width="62" height="60" />`;
		case 'NECK':
			return `<rect x="65" y="55" width="85" height="15" />`;
		case 'LEFT_SHOULDER':
			return `<rect x="141" y="70" width="30" height="17" />`;
		case 'LEFT_ARM':
			return `<rect x="141" y="87" width="35" height="53" />`;
		case 'LEFT_ELBOW':
			return `<rect x="154" y="140" width="30" height="15" />`;
		case 'LEFT_FOREARM':
			return `<rect x="154" y="155" width="30" height="35" />`;
		case 'LEFT_WRIST':
			return `<rect x="163" y="190" width="20" height="10" />`;
		case 'LEFT_HAND':
			return `<rect x="165" y="200" width="40" height="40" />`;
		case 'RIGHT_SHOULDER':
			return `<rect x="41" y="70" width="30" height="17" />`;
		case 'RIGHT_ARM':
			return `<rect x="35" y="87" width="35" height="53" />`;
		case 'RIGHT_ELBOW':
			return `<rect x="35" y="140" width="30" height="15" />`;
		case 'RIGHT_FOREARM':
			return `<rect x="30" y="155" width="30" height="35" />`;
		case 'RIGHT_WRIST':
			return `<rect x="30" y="190" width="20" height="10" />`;
		case 'RIGHT_HAND':
			return `<rect x="8" y="200" width="40" height="40" />`;
		case 'THORAX_LEFT':
			return `<rect x="106" y="70" width="35" height="70" />`;
		case 'THORAX_RIGHT':
			return `<rect x="71" y="70" width="35" height="70" />`;
		case 'ABDOMEN':
			return `<rect x="65" y="140" width="83" height="40" />`;
		case 'PELVIS':
			return `<rect x="64" y="180" width="85" height="40" />`;
		case 'LEFT_THIGH':
			return `<rect x="107" y="220" width="41" height="50" />`;
		case 'LEFT_KNEE':
			return `<rect x="114" y="270" width="35" height="22" />`;
		case 'LEFT_LEG':
			return `<rect x="116" y="292" width="37" height="75" />`;
		case 'LEFT_ANKLE':
			return `<rect x="124" y="367" width="30" height="15" />`;
		case 'LEFT_FOOT':
			return `<rect x="125" y="382" width="37" height="35" />`;
		case 'RIGHT_THIGH':
			return `<rect x="65" y="220" width="41" height="50" />`;
		case 'RIGHT_KNEE':
			return `<rect x="64" y="270" width="35" height="22" />`;
		case 'RIGHT_LEG':
			return `<rect x="59" y="292" width="37" height="75" />`;
		case 'RIGHT_ANKLE':
			return `<rect x="60" y="367" width="30" height="15" />`;
		case 'RIGHT_FOOT':
			return `<rect x="50" y="382" width="37" height="35" />`;
	}
	return;
}

export function getLocalizedBlocks(blocks: string[]) {

	const result: LocalizedBlocks = {
		localized: [],
		not_localized: [],
	}
	let toDisplay: BlockName[] = blocks as BlockName[];

	//toDisplay = allBlocks;
	//toDisplay = extBlocks;
	//toDisplay  = [ "HEAD", "NECK",  "THORAX_LEFT", "THORAX_RIGHT", "LEFT_SHOULDER", "LEFT_FOREARM", "ABDOMEN", "PELVIS"];

	toDisplay.forEach(blockName => {
		const svg = getBlockZone(blockName as BlockName);
		if (svg) {
			result.localized.push({
				blockName,
				svg: `<svg width="220" height="470" viewBox="0 0 240 490" xmlns="http://www.w3.org/2000/svg">
${svg}</svg>`,
			});
		} else {
			result.not_localized.push(blockName);
		}
	});

	return result;
}

export function getLocalizedAfflictedBlocks() {
	return getLocalizedBlocks(getAfflictedBlocks());
}


export function getAllLocalizedBlocks() {
	const afflictedBlocks = getAfflictedBlocks();
	const forTreatments : string[] = Context.patientConsole.state.availableBlocks;

	const mAb = afflictedBlocks.reduce<Record<string, true>>((acc, cur) => {
		acc[cur] = true;
		return acc;
	}, {});

	const tB = forTreatments.reduce<Record<string, true>>((acc, cur) => {
		acc[cur] = true;
		return acc;
	}, {});

	const union = Helpers.uniq([...afflictedBlocks, ...forTreatments]);

	return getLocalizedBlocks(union).localized.map(lb => ({
		...lb,
		observable: mAb[lb.blockName],
		selectable: tB[lb.blockName],
	}));
}
